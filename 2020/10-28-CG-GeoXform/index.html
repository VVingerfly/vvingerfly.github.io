<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=7.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=7.0.0">


  <link rel="mask-icon" href="/images/favicon.ico?v=7.0.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '3LK81CNDL7',
      apiKey: '1e4db2b317be6f71728401d2f4ea1a24',
      indexName: 'VVingerfly_hexo_blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="3D rotation using axis-angle, Euler, Matrix, and quaternion representations.">
<meta name="keywords" content="cg">
<meta property="og:type" content="article">
<meta property="og:title" content="Geometry Rotations">
<meta property="og:url" content="https://VVingerfly.github.io/2020/10-28-CG-GeoXform/index.html">
<meta property="og:site_name" content="Wei&#39;s Blog">
<meta property="og:description" content="3D rotation using axis-angle, Euler, Matrix, and quaternion representations.">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://vvingerfly.github.io/Users/liwei/Documents/CloudDisk/ArcWei/OneDrive/md/aeroplaneGlobal1.png">
<meta property="og:updated_time" content="2023-05-21T15:57:26.068Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Geometry Rotations">
<meta name="twitter:description" content="3D rotation using axis-angle, Euler, Matrix, and quaternion representations.">
<meta name="twitter:image" content="https://vvingerfly.github.io/Users/liwei/Documents/CloudDisk/ArcWei/OneDrive/md/aeroplaneGlobal1.png">






  <link rel="canonical" href="https://VVingerfly.github.io/2020/10-28-CG-GeoXform/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Geometry Rotations | Wei's Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wei's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://VVingerfly.github.io/2020/10-28-CG-GeoXform/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wei LI">
      <meta itemprop="description" content="好记性不如烂笔头">
      <meta itemprop="image" content="/images/avatar_heart.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Geometry Rotations

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-10-28 08:00:00" itemprop="dateCreated datePublished" datetime="2020-10-28T08:00:00+08:00">2020-10-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2023-05-21 23:57:26" itemprop="dateModified" datetime="2023-05-21T23:57:26+08:00">2023-05-21</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cg/" itemprop="url" rel="index"><span itemprop="name">cg</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <a href="/2020/10-28-CG-GeoXform/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/10-28-CG-GeoXform/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          
            <div class="post-description">3D rotation using axis-angle, Euler, Matrix, and quaternion representations.</div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Rotation-Representations"><a href="#Rotation-Representations" class="headerlink" title="Rotation Representations"></a>Rotation Representations</h2><h3 id="Axis-Angle"><a href="#Axis-Angle" class="headerlink" title="Axis-Angle"></a>Axis-Angle</h3><p>三维旋转可以通过一个单位向量即旋转轴，和绕该轴的旋转角来表达，即这里所说的轴角表达方式 (Axis-Angle Representation)。<br>轴角可能是最容易理解的表达三维旋转的方式，但是需要注意的两点是，如果要结合两个旋转，需要将轴角表达转化为矩阵或者四元数形式，另外，在0和180度时，微小的改变会使旋转轴突然变化很大 (there are two singularities at 0° and 180° where the axis can jump suddenly for a small change in input.)。在旋转角为0时，旋转轴可以是任意的单位向量；在旋转角为180度时，旋转轴有两个方向。</p>
<h3 id="Euler-Angles"><a href="#Euler-Angles" class="headerlink" title="Euler Angles"></a>Euler Angles</h3><p>当将三维旋转分解为三个独立的旋转角来表达时，一般称为欧拉角 (Euler Angle)。因为在结合多个旋转时，作用顺序至关重要，所以有多种不同的欧拉角。在使用欧拉角时，以下几点必须明白：</p>
<ul>
<li><p>结合旋转角的顺序 (Order of combining angles)</p>
<p>假设用x,y,z分别表示绕x,y,z坐标轴的一个旋转，所以三维旋转的顺序有xyz, yzx, zxy，颠倒顺序有zyx, xzy, yxz，共计6种方式。但由于绕每个轴旋转并不是独立的，三维旋转还可以结合两个平面的旋转来构成，即xyx, xzx, yxy, yzy, zxz and zyz。所以一共有12种可能的顺序。</p>
</li>
<li><p>相对于旋转物体还是世界坐标系 (Relative to rotating object or absolute coordinates)</p>
<p>旋转角可能是相对于世界坐标系或其他坐标系，也有可能相对于被旋转的物体。</p>
</li>
<li><p>左手还是右手定则 (Left or right hand rotation)</p>
</li>
<li><p>旋转角的单位 (Notation for angles)</p>
</li>
</ul>
<p>一种<a href="http://www.euclideanspace.com/maths/geometry/rotations/euler/index.htm" target="_blank" rel="noopener">欧拉角参考</a><br><img src="/Users/liwei/Documents/CloudDisk/ArcWei/OneDrive/md/aeroplaneGlobal1.png" alt="aeroplaneGlobal1"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">airplane</th>
<th style="text-align:center">telescope</th>
<th style="text-align:center">symbol</th>
<th style="text-align:center">angular velocity</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">applied first</td>
<td style="text-align:center">heading</td>
<td style="text-align:center">azimuth</td>
<td style="text-align:center">$\theta$ (theta)</td>
<td style="text-align:center">yaw</td>
<td>y</td>
</tr>
<tr>
<td style="text-align:center">applied second</td>
<td style="text-align:center">attitude</td>
<td style="text-align:center">elevation</td>
<td style="text-align:center">$\phi$ (phi)</td>
<td style="text-align:center">pitch</td>
<td>z</td>
</tr>
<tr>
<td style="text-align:center">applied last</td>
<td style="text-align:center">bank</td>
<td style="text-align:center">tilt</td>
<td style="text-align:center">$\psi$ (psi)</td>
<td style="text-align:center">roll</td>
<td>x</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Rotation-Matrices"><a href="#Rotation-Matrices" class="headerlink" title="Rotation Matrices"></a>Rotation Matrices</h3><p>三维旋转可以通过 ==行列式为1的正交矩阵== 来表示。</p>
<script type="math/tex; mode=display">
R_x=
\begin{bmatrix}
1 & 0 & 0 \\ 
0 & \cos\theta & \sin\theta \\ 
0 & -\sin\theta & \cos\theta
\end{bmatrix}
R_y=
\begin{bmatrix}
\cos\theta & 0 & \sin\theta \\ 
0 & 1 & 0 \\ 
-\sin\theta & 0 & \cos\theta
\end{bmatrix}
R_z=
\begin{bmatrix}
\cos\theta & \sin\theta & 0 \\ 
-\sin\theta & \cos\theta & 0 \\ 
0 & 0 & 1
\end{bmatrix}</script><p>一个矩阵是旋转矩阵的充要条件是，该矩阵为正交矩阵且行列式为1，即满足$A^TA=A^{-1}A=I$，$det(A)=1$。注意，正交矩阵不一定是旋转阵，如果正交阵的行列式为1，则其为旋转阵，但==如果行列式为-1，则其表示反射矩阵== <a href>4</a>。</p>
<h3 id="Quaternions"><a href="#Quaternions" class="headerlink" title="Quaternions"></a>Quaternions</h3><p>四元数可以表达三维镜像 (reflections)、旋转 (rotations)和缩放 (scaling)，但一个四元数不包含平移，所以如果需要围绕一个非原点的点旋转、镜像或者缩放，需要独立处理平移部分。</p>
<p>当四元数是 ==单位长度== 时，其表示三维旋转，多个四元数相乘则表示多个旋转变换的结合。</p>
<p>此时可以将其看作与轴角类似，只是四元数的实数部分是 <code>cos(angle/2)</code>，虚数部分是旋转轴向量乘以<code>sin(angle/2)</code>，即对于轴角来说，其对应的四元数为</p>
<script type="math/tex; mode=display">
q = \cos(a/2) + i(x*\sin(a/2)) + j(y*\sin(a/2)) + k(z*\sin(a/2))</script><p>其中 $a$ 是旋转角，$[x, y, z]$ 是旋转轴。</p>
<p>四元数 $i$ 表示绕 $x$ 轴旋转180度，$i*i = -1$ 表示绕 $x$ 轴旋转360度，$j, k$ 分别表示绕 $y, z$ 轴旋转180度。如果$(a + b i + c j + d k) $ 表示一个旋转，则 $ (- a - b i - c j - d k) $ 表示相同的旋转，这从轴角表达的角度来看是有道理的，如果将旋转角和旋转轴同时取反，将得到相同的结果。所以1和-1都表示identity旋转（什么都没做）。</p>
<p>虽然只要3个数（如欧拉角）便可以表示三维旋转，但这样的表达是非线性的，不易操作。但如果将三维空间的旋转映射到 ==四维空间的单位球上==，这个问题便变成线性的了。</p>
<h2 id="Rotation-Conversion"><a href="#Rotation-Conversion" class="headerlink" title="Rotation Conversion"></a>Rotation Conversion</h2><h3 id="AxisAngle-to-Others"><a href="#AxisAngle-to-Others" class="headerlink" title="AxisAngle to Others"></a>AxisAngle to Others</h3><h4 id="AxisAngle-to-Euler"><a href="#AxisAngle-to-Euler" class="headerlink" title="AxisAngle to Euler"></a>AxisAngle to Euler</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heading = <span class="built_in">atan2</span>(y*<span class="built_in">sin</span>(angle)-x*z*(<span class="number">1</span>-<span class="built_in">cos</span>(angle)), <span class="number">1</span>-(y2+z2)*(<span class="number">1</span>-<span class="built_in">cos</span>(angle)))</span><br><span class="line">attitude = <span class="built_in">asin</span>(x*y*(<span class="number">1</span>-<span class="built_in">cos</span>(angle)) + z*<span class="built_in">sin</span>(angle)) </span><br><span class="line">bank = <span class="built_in">atan2</span>(x*<span class="built_in">sin</span>(angle)-y*z*(<span class="number">1</span>-<span class="built_in">cos</span>(angle)), <span class="number">1</span>-(x2+z2)*(<span class="number">1</span>-<span class="built_in">cos</span>(angle)))</span><br></pre></td></tr></table></figure>
<p>除了在奇异点处：</p>
<ul>
<li>向上：<code>heading = 2 * atan2(x * sin(angle/2),cos(angle/2))</code>, <code>bank = 0</code></li>
<li>向下：<code>heading = -2 * atan2(x * sin(angle/2),cos(angle/2))</code>, <code>bank = 0</code></li>
</ul>
<p>except at the singularities, straight up:<br>heading = 2 <em> atan2(x </em> sin(angle/2),cos(angle/2))<br>bank = 0<br>straight down:<br>heading = -2 <em> atan2(x </em> sin(angle/2),cos(angle/2))<br>bank = 0</p>
<p>注意：</p>
<ul>
<li>不同的应用场景计算的结果可能不同；</li>
<li>最好使用<code>atan2</code>函数而不是<code>atan</code>函数；</li>
<li>这里假设旋转轴是单位向量满足<code>ax*ax + ay*ay + az*az = 1</code>。</li>
</ul>
<h4 id="AxisAngle-to-Matrix"><a href="#AxisAngle-to-Matrix" class="headerlink" title="AxisAngle to Matrix"></a>AxisAngle to Matrix</h4><p>公式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="number">2</span> * <span class="built_in">acos</span>(qw)</span><br><span class="line">x = qx / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br><span class="line">y = qy / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br><span class="line">z = qz / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br></pre></td></tr></table></figure>
<p>奇异点问题</p>
<p>轴角表示法在角度为0和180度时有两个奇异点，在角度为0时，旋转轴是任意的（任何旋转轴都产生同样的结果），在角度为180度时，旋转轴仍然是无关的，所以此时需要计算旋转轴。</p>
<p>按照轴角表达其对应的四元数为</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q = <span class="built_in">cos</span>(angle/<span class="number">2</span>) + i (x*<span class="built_in">sin</span>(angle/<span class="number">2</span>)) + j (y*<span class="built_in">sin</span>(angle/<span class="number">2</span>)) + k (z*<span class="built_in">sin</span>(angle/<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>角度为0时对应的四元数为<code>q = 1 + i 0 + j 0 + k 0</code>，所以利用上面转化公式<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="number">2</span> * <span class="built_in">acos</span>(qw) = <span class="number">0</span></span><br><span class="line">x = qx / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = divide by zero = infinity</span><br><span class="line">y = qy / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = divide by zero = infinity</span><br><span class="line">z = qz / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = divide by zero = infinity</span><br></pre></td></tr></table></figure></p>
<p>所以此时必须检查除数为0的情况，但这不是问题，因为旋转轴可以被设为任意一个单位化的向量。</p>
<p>角度为180度时对应的四元数为<code>q = 0 + i x + j y + k z</code>，所以利用转化公式有<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="number">2</span> * <span class="built_in">acos</span>(qw) = <span class="number">2</span> * <span class="number">90</span> degrees = <span class="number">180</span> degrees (<span class="keyword">or</span> <span class="number">-180</span> degrees)</span><br><span class="line">x = qx / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = qx</span><br><span class="line">y = qy / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = qy</span><br><span class="line">z = qz / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw) = qw</span><br></pre></td></tr></table></figure></p>
<p>Which is correct so the formula works properly in this case. Although some axis angle calculations can jump suddenly around 180 degrees, this quaternion to axis-angle translation seems quite smooth at this region.</p>
<h4 id="AxisAngle-to-Quaternion"><a href="#AxisAngle-to-Quaternion" class="headerlink" title="AxisAngle to Quaternion"></a>AxisAngle to Quaternion</h4><p>公式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qx = ax * <span class="built_in">sin</span>(angle/<span class="number">2</span>)</span><br><span class="line">qy = ay * <span class="built_in">sin</span>(angle/<span class="number">2</span>)</span><br><span class="line">qz = az * <span class="built_in">sin</span>(angle/<span class="number">2</span>)</span><br><span class="line">qw = <span class="built_in">cos</span>(angle/<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ul>
<li>旋转轴是标准化后的，即满足<code>ax*ax + ay*ay + az*az = 1</code></li>
<li>四元数同样是标准化后的，满足<code>cos(angle/2)^2 + ax*ax*sin(angle/2)^2 + ay*ay*sin(angle/2)^2+ az*az*sin(angle/2)^2 = 1</code></li>
</ul>
<h3 id="Euler-to-Others"><a href="#Euler-to-Others" class="headerlink" title="Euler to Others"></a>Euler to Others</h3><h4 id="Euler-to-AxisAngle"><a href="#Euler-to-AxisAngle" class="headerlink" title="Euler to AxisAngle"></a>Euler to AxisAngle</h4><p>公式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="number">2</span> * <span class="built_in">acos</span>(c1c2c3 - s1s2s3)</span><br><span class="line">x = s1 s2 c3 +c1 c2 s3</span><br><span class="line">y = s1 c2 c3 + c1 s2 s3</span><br><span class="line">z = c1 s2 c3 - s1 c2 s3</span><br></pre></td></tr></table></figure>
<p>为了归一化旋转轴<code>x</code>, <code>y</code> , <code>z</code>需分别除以：</p>
<p><code>sqrt(x^2 + y^2 + z^2) = sqrt((s1 s2 c3 +c1 c2 s3)^2+(s1 c2 c3 + c1 s2 s3)^2+(c1 s2 c3 - s1 c2 s3)^2)</code></p>
<p>这里：</p>
<ul>
<li>c1 = cos(heading / 2)</li>
<li>c2 = cos(attitude / 2)</li>
<li>c3 = cos(bank / 2)</li>
<li>s1 = sin(heading / 2)</li>
<li>s2 = sin(attitude / 2)</li>
<li>s3 = sin(bank / 2)</li>
</ul>
<h4 id="Euler-to-Matrix"><a href="#Euler-to-Matrix" class="headerlink" title="Euler to Matrix"></a>Euler to Matrix</h4><script type="math/tex; mode=display">
R =
\begin{bmatrix}
ch*ca & -ch*sa*cb + sh*sb & ch*sa*sb + sh*cb \\ 
sa    & ca*cb    & -ca*sb \\ 
-sh*ca & sh*sa*cb + ch*sb & -sh*sa*sb + ch*cb
\end{bmatrix}</script><p>这里：</p>
<ul>
<li>sa = sin(attitude)</li>
<li>ca = cos(attitude)</li>
<li>sb = sin(bank)</li>
<li>cb = cos(bank)</li>
<li>sh = sin(heading)</li>
<li>ch = cos(heading)</li>
</ul>
<p>==注意==：具体的转化公式由欧拉角的顺序有关。</p>
<h4 id="Euler-to-Quaternion"><a href="#Euler-to-Quaternion" class="headerlink" title="Euler to Quaternion"></a>Euler to Quaternion</h4><p>第一种方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">w = c1 c2 c3 - s1 s2 s3</span><br><span class="line">x = s1 s2 c3 + c1 c2 s3</span><br><span class="line">y = s1 c2 c3 + c1 s2 s3</span><br><span class="line">z = c1 s2 c3 - s1 c2 s3</span><br></pre></td></tr></table></figure>
<p>where:</p>
<ul>
<li>c1 = cos(heading / 2), c2 = cos(attitude / 2), c3 = cos(bank / 2)</li>
<li>s1 = sin(heading / 2), s2 = sin(attitude / 2), s3 = sin(bank / 2)</li>
</ul>
<p>An alternative form is:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">w = Math.<span class="built_in">sqrt</span>(<span class="number">1.0</span> + C1 * C2 + C1*C3 - S1 * S2 * S3 + C2*C3) / <span class="number">2</span></span><br><span class="line">x = (C2 * S3 + C1 * S3 + S1 * S2 * C3) / (<span class="number">4.0</span> * w) </span><br><span class="line">y = (S1 * C2 + S1 * C3 + C1 * S2 * S3) / (<span class="number">4.0</span> * w)</span><br><span class="line">z = (-S1 * S3 + C1 * S2 * C3 + S2) /(<span class="number">4.0</span> * w)</span><br></pre></td></tr></table></figure></p>
<p>where:</p>
<ul>
<li>C1 = cos(heading), C2 = cos(attitude), C3 = cos(bank)</li>
<li>S1 = sin(heading), S2 = sin(attitude), S3 = sin(bank)</li>
</ul>
<p>note: in the second form the angles are not divided by 2. I don’t know which of these forms is most stable? However, as <a href="http://www.euclideanspace.com/maths/geometry/rotations/correspondance3.htm" target="_blank" rel="noopener">William</a> points out the first is better because it requires the same number of trig operations, no square root, no worry about dividing by zero, uses familiar formulae, and is fairly clearly normalised.</p>
<h3 id="Matrix-to-Others"><a href="#Matrix-to-Others" class="headerlink" title="Matrix to Others"></a>Matrix to Others</h3><h4 id="Matrix-to-AxisAngle"><a href="#Matrix-to-AxisAngle" class="headerlink" title="Matrix to AxisAngle"></a>Matrix to AxisAngle</h4><p>一个3x3的矩阵有9个元素，包含了一些重复的信息，因此有多种方式来推导出旋转，下面是其中的一种：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="built_in">acos</span>(( m00 + m11 + m22 - <span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">x = (m21 - m12) / <span class="built_in">sqrt</span>((m21 - m12)^<span class="number">2</span>+(m02 - m20)^<span class="number">2</span>+(m10 - m01)^<span class="number">2</span>)</span><br><span class="line">y = (m02 - m20) / <span class="built_in">sqrt</span>((m21 - m12)^<span class="number">2</span>+(m02 - m20)^<span class="number">2</span>+(m10 - m01)^<span class="number">2</span>)</span><br><span class="line">z = (m10 - m01) / <span class="built_in">sqrt</span>((m21 - m12)^<span class="number">2</span>+(m02 - m20)^<span class="number">2</span>+(m10 - m01)^<span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<p>在角度为0或者180度时，上面的公式可能会出问题，所以必须单独测试这两种情况。在角度为0时，旋转轴可以是任意的，在角度为180时，角度仍然是相关的需要去计算它。</p>
<h4 id="Matrix-to-Euler"><a href="#Matrix-to-Euler" class="headerlink" title="Matrix to Euler"></a>Matrix to Euler</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heading = <span class="built_in">atan2</span>(-m20,m00)</span><br><span class="line">attitude = <span class="built_in">asin</span>(m10) </span><br><span class="line">bank = <span class="built_in">atan2</span>(-m12,m11)</span><br></pre></td></tr></table></figure>
<p>except when <code>m10=1</code> (north pole), which gives: <code>heading = atan2(m02, m22), bank = 0</code> and when <code>m10=-1</code> (south pole), which gives: <code>heading = atan2(m02, m22), bank = 0</code>.</p>
<h4 id="Matrix-to-Quaternion"><a href="#Matrix-to-Quaternion" class="headerlink" title="Matrix to Quaternion"></a>Matrix to Quaternion</h4><p>对于一个旋转矩阵，同时满足正交阵并且==行列式为1==det(matrix)= +1，则该矩阵能够通过下面的公式转化为四元数：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qw= <span class="built_in">sqrt</span>(<span class="number">1</span> + m00 + m11 + m22) / <span class="number">2</span></span><br><span class="line">qx = (m21-m12) / (<span class="number">4</span>*qw)</span><br><span class="line">qy = (m02-m20) / (<span class="number">4</span>*qw)</span><br><span class="line">qz = (m10-m01) / (<span class="number">4</span>*qw)</span><br></pre></td></tr></table></figure></p>
<p>但注意该公式必须满足矩阵为正交阵且行列式为1的条件。例如下面的矩阵表示绕着y轴旋转180度</p>
<script type="math/tex; mode=display">
R_y =
\begin{bmatrix}
-1 & 0 & 0 \\ 
0  & 1 & 0 \\ 
0  & 0 & -1
\end{bmatrix}</script><p>是正交阵但行列式不为1，此时<code>1 + m00 + m11 + m22 = 0</code>即<code>qw=0</code>，无法适用上面的公式。即使<code>qw</code>的值很小不为0，在做除法时也可能产生很大的误差。</p>
<p>另外一种方法为<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">qw = <span class="built_in">sqrt</span>( max( <span class="number">0</span>, <span class="number">1</span> + m00 + m11 + m22 )  )  /  <span class="number">2</span>;</span><br><span class="line">qx = <span class="built_in">sqrt</span>( max( <span class="number">0</span>, <span class="number">1</span> + m00 - m11 - m22 ) ) / <span class="number">2</span>;</span><br><span class="line">qy = <span class="built_in">sqrt</span>( max( <span class="number">0</span>, <span class="number">1</span> - m00 + m11 - m22 ) ) / <span class="number">2</span>;</span><br><span class="line">qz = <span class="built_in">sqrt</span>( max( <span class="number">0</span>, <span class="number">1</span> - m00 - m11 + m22 ) ) / <span class="number">2</span>;</span><br><span class="line">qx = copysign( qx, m21 - m12 )</span><br><span class="line">qy = copysign( qy, m02 - m20 )</span><br><span class="line">qz = copysign( qz, m10 - m01 )</span><br></pre></td></tr></table></figure></p>
<p>copysign函数将第二个参数的符号赋值给第一个参数的符号。</p>
<h3 id="Quaternion-to-Others"><a href="#Quaternion-to-Others" class="headerlink" title="Quaternion to Others"></a>Quaternion to Others</h3><h4 id="Quaternion-to-AxisAngle"><a href="#Quaternion-to-AxisAngle" class="headerlink" title="Quaternion to AxisAngle"></a>Quaternion to AxisAngle</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">angle = <span class="number">2</span> * <span class="built_in">acos</span>(qw)</span><br><span class="line">x = qx / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br><span class="line">y = qy / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br><span class="line">z = qz / <span class="built_in">sqrt</span>(<span class="number">1</span>-qw*qw)</span><br></pre></td></tr></table></figure>
<p>由于轴角表示在0和180度时有两个奇异点，所以需要特别对待。前面说过基于轴角表示的四元数可表示为<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q = <span class="built_in">cos</span>(angle/<span class="number">2</span>) + i ( x * <span class="built_in">sin</span>(angle/<span class="number">2</span>)) + j (y * <span class="built_in">sin</span>(angle/<span class="number">2</span>)) + k ( z * <span class="built_in">sin</span>(angle/<span class="number">2</span>))</span><br></pre></td></tr></table></figure></p>
<ul>
<li>在角度为0时，<code>q = 1 + i 0 + j 0 + k 0</code>，即<code>qw = 1</code>此时旋转角为0，旋转轴可以设为任意的单位向量</li>
<li>在角度为180时，<code>q = 0 + i x + j y + k z</code>，即<code>qw = 0</code>，此时<code>angle = 2 * acos(qw) = 2 * 90 degrees = 180 degrees (or -180 degrees)</code>，<code>x = qx, y = qy, z = qz</code>，所以上述公式适用，虽然轴角在180度时会突变，但四元素到轴角的转换在该角度附件是连续的。</li>
</ul>
<h4 id="Quaternion-to-Euler"><a href="#Quaternion-to-Euler" class="headerlink" title="Quaternion to Euler"></a>Quaternion to Euler</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heading = <span class="built_in">atan2</span>(<span class="number">2</span>*qy*qw<span class="number">-2</span>*qx*qz , <span class="number">1</span> - <span class="number">2</span>*qy2 - <span class="number">2</span>*qz2)</span><br><span class="line">attitude = <span class="built_in">asin</span>(<span class="number">2</span>*qx*qy + <span class="number">2</span>*qz*qw) </span><br><span class="line">bank = <span class="built_in">atan2</span>(<span class="number">2</span>*qx*qw<span class="number">-2</span>*qy*qz , <span class="number">1</span> - <span class="number">2</span>*qx2 - <span class="number">2</span>*qz2)</span><br></pre></td></tr></table></figure>
<p>except when <code>qx*qy + qz*qw = 0.5</code> (north pole)<br>which gives: <code>heading = 2 * atan2(x,w), bank = 0</code><br>and when <code>qx*qy + qz*qw = -0.5</code> (south pole)<br>which gives: <code>heading = -2 * atan2(x,w), bank = 0</code></p>
<h4 id="Quaternion-to-Matrix"><a href="#Quaternion-to-Matrix" class="headerlink" title="Quaternion to Matrix"></a>Quaternion to Matrix</h4><p>如果一个四元素是<code>qw + i qx + j qy + k qz</code>，则对应的表示同样旋转的矩阵为：</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
1 - 2*qy^2 - 2*qz^2 &    2*qx*qy - 2*qz*qw &    2*qx*qz + 2*qy*qw \\
2*qx*qy + 2*qz*qw &    1 - 2*qx^2 - 2*qz^2 &    2*qy*qz - 2*qx*qw \\
2*qx*qz - 2*qy*qw &    2*qy*qz + 2*qx*qw &    1 - 2*qx^2 - 2*qy^2
\end{bmatrix}</script><h2 id="Rotation-in-Eigen"><a href="#Rotation-in-Eigen" class="headerlink" title="Rotation in Eigen"></a>Rotation in Eigen</h2><p>Eigen 库的 Geometry 模块提供了一个几何变换。</p>
<h3 id="Eigen-AngleAxis"><a href="#Eigen-AngleAxis" class="headerlink" title="Eigen::AngleAxis"></a>Eigen::AngleAxis</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AngleAxis&lt;<span class="keyword">float</span>&gt; aa(angle_in_radian, Vector3f(ax,ay,az)); <span class="comment">// axis vector must be normalized</span></span><br><span class="line"></span><br><span class="line">AngleAxisf aa; aa = Matrix3f(..);  <span class="comment">// assumes a pure rotation matrix, use m.isUnitary()</span></span><br><span class="line">Matrix3f   m;  m  = AngleAxisf(..)</span><br><span class="line"></span><br><span class="line">AngleAxisf aa;  aa = Quaternionf(..);</span><br><span class="line">Quaternionf q;  q = AngleAxisf(..);</span><br></pre></td></tr></table></figure>
<h3 id="Eigen-Quaternion"><a href="#Eigen-Quaternion" class="headerlink" title="Eigen::Quaternion"></a>Eigen::Quaternion</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Quaternion&lt;<span class="keyword">float</span>&gt; q(w, x, y, z);</span><br><span class="line"></span><br><span class="line">Quaternionf q;  q = AngleAxisf(..);</span><br><span class="line">AngleAxisf aa;  aa = Quaternionf(..);</span><br><span class="line"></span><br><span class="line">Quaternionf q;  q  = Matrix3f(..);</span><br><span class="line">Matrix3f m;     m  = Quaternionf(..);</span><br></pre></td></tr></table></figure>
<h3 id="Eigen-MatrixBase"><a href="#Eigen-MatrixBase" class="headerlink" title="Eigen::MatrixBase"></a>Eigen::MatrixBase</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vector3f ea = mat.eulerAngles(<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>); <span class="comment">// The returned angles are in the ranges [0:pi]x[-pi:pi]x[-pi:pi].</span></span><br><span class="line">mat == AngleAxisf(ea[<span class="number">0</span>], Vector3f::UnitY())</span><br><span class="line">     * AngleAxisf(ea[<span class="number">1</span>], Vector3f::UnitX())</span><br><span class="line">     * AngleAxisf(ea[<span class="number">2</span>], Vector3f::UnitZ());</span><br></pre></td></tr></table></figure>
<h2 id="Rotation-for-Deep-Learning"><a href="#Rotation-for-Deep-Learning" class="headerlink" title="Rotation for Deep Learning"></a>Rotation for Deep Learning</h2><h3 id="6D"><a href="#6D" class="headerlink" title="6D"></a>6D</h3><h3 id="SVD"><a href="#SVD" class="headerlink" title="SVD"></a>SVD</h3><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><ol>
<li><a href="https://www.euclideanspace.com/" target="_blank" rel="noopener">Euclidean Space</a></li>
<li><a href="https://www.andre-gaschler.com/rotationconverter/" target="_blank" rel="noopener">rotationconverter</a></li>
<li><a href="http://eigen.tuxfamily.org/dox/group__TutorialGeometry.html" target="_blank" rel="noopener">Eigen Geometry</a></li>
<li><a href="https://blog.csdn.net/dfdfdsfdfdfdf/article/details/53213240" target="_blank" rel="noopener">SVD分解（奇异值分解）求旋转矩阵</a></li>
<li>On the Continuity of Rotation Representations in Neural Networks</li>
<li>An Analysis of SVD for Deep Rotation Estimation</li>
</ol>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Wei LI WeChat Pay">
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Wei LI Alipay">
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        



  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者:  </strong>Wei LI</li>
  <li class="post-copyright-link">
    <strong>本文链接: </strong>
    
    <a href="https://VVingerfly.github.io/2020/10-28-CG-GeoXform/" title="Geometry Rotations">https://VVingerfly.github.io/2020/10-28-CG-GeoXform/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明:  </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/cg/" rel="tag"># cg</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07-31-Tips4Conda/" rel="next" title="Tips for Conda">
                <i class="fa fa-chevron-left"></i> Tips for Conda
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/06-01-CG-Quaternion/" rel="prev" title="Rotations with Quaternions">
                Rotations with Quaternions <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar_heart.JPG" alt="Wei LI">
            
              <p class="site-author-name" itemprop="name">Wei LI</p>
              <p class="site-description motion-element" itemprop="description">好记性不如烂笔头</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">81</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">34</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">34</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/VVingerfly" title="GitHub &rarr; https://github.com/VVingerfly" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:wei587me@163.com" title="E-Mail &rarr; mailto:wei587me@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Rotation-Representations"><span class="nav-number">1.</span> <span class="nav-text">Rotation Representations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Axis-Angle"><span class="nav-number">1.1.</span> <span class="nav-text">Axis-Angle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Euler-Angles"><span class="nav-number">1.2.</span> <span class="nav-text">Euler Angles</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rotation-Matrices"><span class="nav-number">1.3.</span> <span class="nav-text">Rotation Matrices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Quaternions"><span class="nav-number">1.4.</span> <span class="nav-text">Quaternions</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rotation-Conversion"><span class="nav-number">2.</span> <span class="nav-text">Rotation Conversion</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AxisAngle-to-Others"><span class="nav-number">2.1.</span> <span class="nav-text">AxisAngle to Others</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#AxisAngle-to-Euler"><span class="nav-number">2.1.1.</span> <span class="nav-text">AxisAngle to Euler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AxisAngle-to-Matrix"><span class="nav-number">2.1.2.</span> <span class="nav-text">AxisAngle to Matrix</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AxisAngle-to-Quaternion"><span class="nav-number">2.1.3.</span> <span class="nav-text">AxisAngle to Quaternion</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Euler-to-Others"><span class="nav-number">2.2.</span> <span class="nav-text">Euler to Others</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Euler-to-AxisAngle"><span class="nav-number">2.2.1.</span> <span class="nav-text">Euler to AxisAngle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Euler-to-Matrix"><span class="nav-number">2.2.2.</span> <span class="nav-text">Euler to Matrix</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Euler-to-Quaternion"><span class="nav-number">2.2.3.</span> <span class="nav-text">Euler to Quaternion</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Matrix-to-Others"><span class="nav-number">2.3.</span> <span class="nav-text">Matrix to Others</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Matrix-to-AxisAngle"><span class="nav-number">2.3.1.</span> <span class="nav-text">Matrix to AxisAngle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Matrix-to-Euler"><span class="nav-number">2.3.2.</span> <span class="nav-text">Matrix to Euler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Matrix-to-Quaternion"><span class="nav-number">2.3.3.</span> <span class="nav-text">Matrix to Quaternion</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Quaternion-to-Others"><span class="nav-number">2.4.</span> <span class="nav-text">Quaternion to Others</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Quaternion-to-AxisAngle"><span class="nav-number">2.4.1.</span> <span class="nav-text">Quaternion to AxisAngle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Quaternion-to-Euler"><span class="nav-number">2.4.2.</span> <span class="nav-text">Quaternion to Euler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Quaternion-to-Matrix"><span class="nav-number">2.4.3.</span> <span class="nav-text">Quaternion to Matrix</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rotation-in-Eigen"><span class="nav-number">3.</span> <span class="nav-text">Rotation in Eigen</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Eigen-AngleAxis"><span class="nav-number">3.1.</span> <span class="nav-text">Eigen::AngleAxis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Eigen-Quaternion"><span class="nav-number">3.2.</span> <span class="nav-text">Eigen::Quaternion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Eigen-MatrixBase"><span class="nav-number">3.3.</span> <span class="nav-text">Eigen::MatrixBase</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rotation-for-Deep-Learning"><span class="nav-number">4.</span> <span class="nav-text">Rotation for Deep Learning</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6D"><span class="nav-number">4.1.</span> <span class="nav-text">6D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SVD"><span class="nav-number">4.2.</span> <span class="nav-text">SVD</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Refs"><span class="nav-number">5.</span> <span class="nav-text">Refs</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wei LI</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>





  <script>
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=65448947";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>





        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.0"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.0"></script>
<script src="/js/src/post-details.js?v=7.0.0"></script>



  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>



  
  
  <script id="dsq-count-scr" src="https://wei587.disqus.com/count.js" async></script>


<script>
  var disqus_config = function() {
    this.page.url = "https://VVingerfly.github.io/2020/10-28-CG-GeoXform/";
    this.page.identifier = "2020/10-28-CG-GeoXform/";
    this.page.title = 'Geometry Rotations';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://wei587.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
  
    loadComments();
  
</script>





  


  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=7.0.0"></script>



  

  

  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: "AMS"
      }
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
      for (i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<style>
.MathJax_Display {
  overflow: auto hidden;
}
</style>

    
  


  

  

  

  

  

  

  

  

</body>
</html>
